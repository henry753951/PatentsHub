// ========================
// 專利
// ========================
model Patent {
  PatentID     Int                        @id @default(autoincrement())
  DepartmentID Int
  // 專利資料
  Year         String
  DraftTitle   String                     @default("")
  Title        String                     @default("")
  TitleEnglish String                     @default("")
  CountryID    Int?
  country      Country?                   @relation(fields: [CountryID], references: [CountryID])
  department   Department                 @relation(fields: [DepartmentID], references: [DepartmentID])
  PatentType   EnumPatentType?
  inventors    PatentInventor[]
  application  PatentApplicationData?
  funding      PatentFunding?
  status       PatentStatus?
  technical    PatentTechnicalAttributes?
  internal     PatentInternal?
  external     PatentExternal?
  PatentRecord PatentRecord[]
}

// ========================

// ========================
// 專利申請資訊
// ========================

enum EnumPatentType {
  INVENTION // 發明專利
  UTILITY_MODEL // 新型專利
  DESIGN // 設計專利
  PLANT // 植物專利 (US only)
}

model PatentApplicationData {
  PatentID          Int       @id @default(autoincrement())
  // 申請後的資料
  ApplicationNumber String? // 申請案號
  FilingDate        DateTime? // 申請日
  // Strike
  RDResultNumber    String? // 研究成果編號
  NSCNumber         String? // 國科會編號

  patent Patent @relation(fields: [PatentID], references: [PatentID])
}

// ========================

// ========================
// 專利技術資訊
// ========================

model PatentTechnicalAttributes {
  PatentID      Int                @id
  MaturityLevel String?
  keywords      TechnicalKeyword[]
  patent        Patent             @relation(fields: [PatentID], references: [PatentID])
}

model TechnicalKeyword {
  KeywordID                 Int                         @id @default(autoincrement())
  Keyword                   String                      @unique
  patentTechnicalAttributes PatentTechnicalAttributes[]
}

// ========================

// ========================
// 專利校內資訊
// ========================

model PatentInternal {
  PatentID              Int                         @id
  InternalID            String                      @unique // 校內編號
  InitialReviewDate     DateTime?
  InitialReviewNumber   String?
  InitialReviewAgencies PatentInitiatorAgencyUnit[] // 初評事務所
  TakerAgencies         PatentTakerAgencyUnit[] // 承辦事務所
  Patent                Patent                      @relation(fields: [PatentID], references: [PatentID])
}

// ========================

// ========================
// 專利對外資訊
// ========================
model PatentExternal {
  PatentID Int @id

  PatentNumber    String? // 專利號碼
  PublicationDate DateTime? // 公開日
  StartDate       DateTime? // 開始日
  EndDate         DateTime? // 結束日
  IPCNumber       String? // IPC號碼
  PatentScope     String? // 專利範圍
  patent          Patent    @relation(fields: [PatentID], references: [PatentID])
}

// ========================
// 專利維護資訊
// ========================

model PatentStatus {
  PatentID                     Int       @id @default(autoincrement())
  ExpiryDate                   DateTime?
  Status                       String
  TechnicalCommitteeReviewDate DateTime?
  MaintenanceYear              Int?
  MaintenanceStartDate         DateTime?
  MaintenanceEndDate           DateTime?
  patent                       Patent    @relation(fields: [PatentID], references: [PatentID])
}

// ========================
//專利紀錄
// ========================
model PatentRecord {
  id       Int      @id @default(autoincrement()) // 添加獨立主鍵
  PatentID Int                               // 外鍵，指向 Patent
  Record   String?                           // 紀錄
  Date     DateTime?                         // 日期
  patent   Patent   @relation(fields: [PatentID], references: [PatentID])
}